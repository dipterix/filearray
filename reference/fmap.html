<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Map multiple file arrays and save results — fmap • filearray</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Map multiple file arrays and save results — fmap" />
<meta property="og:description" content="Advanced mapping function for multiple file arrays. fmap
runs the mapping functions and stores the results in file arrays. 
fmap2 stores results in memory. This 
feature is experimental. There are several constraints to the input. 
Failure to meet these constraints may result in undefined results, or 
even crashes. Please read Section 'Details' carefully before using 
this function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">filearray</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/performance.html">Performance Comparisons - (Numerical)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dipterix/filearray/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Map multiple file arrays and save results</h1>
    <small class="dont-index">Source: <a href='https://github.com/dipterix/filearray/blob/master/R/map.R'><code>R/map.R</code></a></small>
    <div class="hidden name"><code>fmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Advanced mapping function for multiple file arrays. <code>fmap</code>
runs the mapping functions and stores the results in file arrays. 
<code>fmap2</code> stores results in memory. This 
feature is experimental. There are several constraints to the input. 
Failure to meet these constraints may result in undefined results, or 
even crashes. Please read Section 'Details' carefully before using 
this function.</p>
    </div>

    <pre class="usage"><span class='fu'>fmap</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>fun</span>, <span class='va'>.y</span>, .input_size <span class='op'>=</span> <span class='cn'>NA</span>, .output_size <span class='op'>=</span> <span class='cn'>NA</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>fmap2</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>fun</span>, .input_size <span class='op'>=</span> <span class='cn'>NA</span>, .simplify <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>fmap_element_wise</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>fun</span>, <span class='va'>.y</span>, <span class='va'>...</span>, .input_size <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a list of file arrays to map; each element of <code>x</code> must 
share the same dimensions.</p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p>function that takes one list</p></td>
    </tr>
    <tr>
      <th>.y</th>
      <td><p>a file array object, used to save results</p></td>
    </tr>
    <tr>
      <th>.input_size</th>
      <td><p>number of elements to read from each array of <code>x</code></p></td>
    </tr>
    <tr>
      <th>.output_size</th>
      <td><p><code>fun</code> output vector length</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passing to <code>fun</code></p></td>
    </tr>
    <tr>
      <th>.simplify</th>
      <td><p>whether to apply <code><a href='https://rdrr.io/r/base/lapply.html'>simplify2array</a></code> to 
the result</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>File array instance <code>.y</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Denote the first argument of <code>fun</code> as <code>input</code>, The length 
of <code>input</code> equals the length of <code>x</code>. The size of each
element of <code>input</code> is defined by <code>.input_size</code>, except for the
last loop. For example, given dimension of each input array as 
\(10x10x10x10\), if <code>.input_size=100</code>, then 
<code>length(input[[1]])=100</code>. The total number of runs equals to
<code>length(x[[1]])/100</code>. If <code>.input_size=300</code>, then 
<code>length(input[[1]])</code> will be <code>300</code> except for the last run. 
This is because \(10000\) cannot be divided by <code>300</code>. 
The element length of the last run will be <code>100</code>.</p>
<p>The returned variable length of <code>fun</code> will be checked by 
<code>.output_size</code>. If the output length exceed <code>.output_size</code>, 
an error will be raised.</p>
<p>Please make sure that <code>length(.y)/length(x[[1]])</code> equals to 
<code>.output_size/.input_size</code>.</p>
<p>For <code>fmap_element_wise</code>, the <code>input[[1]]</code> and output length 
must be the consistent.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='filearray.html'>filearray_create</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>, dimension <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>20</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x1</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6000</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='filearray.html'>filearray_create</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>, dimension <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>20</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x2</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>6000</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Add two arrays</span></span>
<span class='r-in'><span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='filearray.html'>filearray_create</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>, dimension <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>20</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>fmap</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>    <span class='va'>input</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>input</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span></span>
<span class='r-in'><span class='op'>}</span>, <span class='va'>output</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Reference class object of class "FileArray"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Mode: readwrite </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Dimension: 100x20x3 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> # of partitions: 3 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Partition size: 1 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Storage type: double (internal size: 8)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Location: /tmp/RtmpXwmHJ7/file2f5e796af01c </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># check</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>x2</span><span class='op'>[</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0 0</span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>output</span><span class='op'>$</span><span class='fu'>delete</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Calculate the maximum of x1/x2 for every 100 elements</span></span>
<span class='r-in'><span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='filearray.html'>filearray_create</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>, dimension <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>fmap</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>    <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>input</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>input</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span>, <span class='va'>output</span>, .input_size <span class='op'>=</span> <span class='fl'>100</span>, .output_size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Reference class object of class "FileArray"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Mode: readwrite </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Dimension: 20x3 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> # of partitions: 3 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Partition size: 1 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Storage type: double (internal size: 8)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Location: /tmp/RtmpXwmHJ7/file2f5e1020784f </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># check</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>-</span> <span class='fu'><a href='apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>x2</span><span class='op'>[</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span>, <span class='va'>max</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0 0</span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>output</span><span class='op'>$</span><span class='fu'>delete</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># A large array example</span></span>
<span class='r-in'><span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>    <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='filearray.html'>filearray_create</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>, dimension <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>287</span>, <span class='fl'>100</span>, <span class='fl'>301</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'>    <span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span class='r-in'>        Trial <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>287</span>,</span>
<span class='r-in'>        Marker <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>,</span>
<span class='r-in'>        Time <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>301</span>,</span>
<span class='r-in'>        Location <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span></span>
<span class='r-in'>    <span class='op'>)</span></span>
<span class='r-in'>    </span>
<span class='r-in'>    <span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>        <span class='va'>x</span><span class='op'>[</span>,,,<span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>8638700</span><span class='op'>)</span></span>
<span class='r-in'>    <span class='op'>}</span></span>
<span class='r-in'>    <span class='co'># Step 1:</span></span>
<span class='r-in'>    <span class='co'># for each location, trial, and marker, calibrate (baseline)</span></span>
<span class='r-in'>    <span class='co'># according to first 50 time-points</span></span>
<span class='r-in'>    </span>
<span class='r-in'>    <span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='filearray.html'>filearray_create</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>, dimension <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'>    </span>
<span class='r-in'>    <span class='co'># baseline-percentage change</span></span>
<span class='r-in'>    <span class='fu'>fmap</span><span class='op'>(</span></span>
<span class='r-in'>        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, </span>
<span class='r-in'>        <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>            <span class='co'># get locational data</span></span>
<span class='r-in'>            <span class='va'>location_data</span> <span class='op'>&lt;-</span> <span class='va'>input</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span></span>
<span class='r-in'>            <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>location_data</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>287</span>, <span class='fl'>100</span>, <span class='fl'>301</span><span class='op'>)</span></span>
<span class='r-in'>            </span>
<span class='r-in'>            <span class='co'># collapse over first 50 time points for </span></span>
<span class='r-in'>            <span class='co'># each trial, and marker</span></span>
<span class='r-in'>            <span class='va'>baseline</span> <span class='op'>&lt;-</span> <span class='fu'><a href='apply.html'>apply</a></span><span class='op'>(</span><span class='va'>location_data</span><span class='op'>[</span>,,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, <span class='va'>mean</span><span class='op'>)</span></span>
<span class='r-in'>            </span>
<span class='r-in'>            <span class='co'># calibrate</span></span>
<span class='r-in'>            <span class='va'>calibrated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sweep.html'>sweep</a></span><span class='op'>(</span><span class='va'>location_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, <span class='va'>baseline</span>, </span>
<span class='r-in'>                                FUN <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>bl</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>                                    <span class='op'>(</span><span class='va'>data</span> <span class='op'>/</span> <span class='va'>bl</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>100</span></span>
<span class='r-in'>                                <span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'>            <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>calibrated</span><span class='op'>)</span></span>
<span class='r-in'>        <span class='op'>}</span>, </span>
<span class='r-in'>        </span>
<span class='r-in'>        .y <span class='op'>=</span> <span class='va'>output</span>,</span>
<span class='r-in'>        </span>
<span class='r-in'>        <span class='co'># input dimension is 287 x 100 x 301 for each location</span></span>
<span class='r-in'>        .input_size <span class='op'>=</span> <span class='fl'>8638700</span>,</span>
<span class='r-in'>        </span>
<span class='r-in'>        <span class='co'># output dimension is 287 x 100 x 301</span></span>
<span class='r-in'>        .output_size <span class='op'>=</span> <span class='fl'>8638700</span></span>
<span class='r-in'>    <span class='op'>)</span></span>
<span class='r-in'>    </span>
<span class='r-in'>    <span class='co'># cleanup</span></span>
<span class='r-in'>    <span class='va'>x</span><span class='op'>$</span><span class='fu'>delete</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'>    </span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># cleanup</span></span>
<span class='r-in'><span class='va'>x1</span><span class='op'>$</span><span class='fu'>delete</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>x2</span><span class='op'>$</span><span class='fu'>delete</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>output</span><span class='op'>$</span><span class='fu'>delete</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhengjia Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


