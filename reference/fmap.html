<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Map multiple file arrays and save results — fmap • filearray</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Map multiple file arrays and save results — fmap"><meta name="description" content="Advanced mapping function for multiple file arrays. fmap
runs the mapping functions and stores the results in file arrays.
fmap2 stores results in memory. This
feature is experimental. There are several constraints to the input.
Failure to meet these constraints may result in undefined results, or
even crashes. Please read Section 'Details' carefully before using
this function."><meta property="og:description" content="Advanced mapping function for multiple file arrays. fmap
runs the mapping functions and stores the results in file arrays.
fmap2 stores results in memory. This
feature is experimental. There are several constraints to the input.
Failure to meet these constraints may result in undefined results, or
even crashes. Please read Section 'Details' carefully before using
this function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">filearray</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/performance.html">Performance Comparisons - (Numerical)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dipterix/filearray/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Map multiple file arrays and save results</h1>
      <small class="dont-index">Source: <a href="https://github.com/dipterix/filearray/blob/main/R/method-map.R" class="external-link"><code>R/method-map.R</code></a></small>
      <div class="d-none name"><code>fmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Advanced mapping function for multiple file arrays. <code>fmap</code>
runs the mapping functions and stores the results in file arrays.
<code>fmap2</code> stores results in memory. This
feature is experimental. There are several constraints to the input.
Failure to meet these constraints may result in undefined results, or
even crashes. Please read Section 'Details' carefully before using
this function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fmap</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">fun</span>,</span>
<span>  .y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .buffer_count <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>  .output_size <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fmap2</span><span class="op">(</span><span class="va">x</span>, <span class="va">fun</span>, .buffer_count <span class="op">=</span> <span class="cn">NA</span>, .simplify <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fmap_element_wise</span><span class="op">(</span><span class="va">x</span>, <span class="va">fun</span>, <span class="va">.y</span>, <span class="va">...</span>, .input_size <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a list of file arrays to map; each element of <code>x</code> must
share the same dimensions.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>function that takes one list</p></dd>


<dt id="arg--y">.y<a class="anchor" aria-label="anchor" href="#arg--y"></a></dt>
<dd><p>a file array object, used to save results</p></dd>


<dt id="arg--buffer-count">.buffer_count<a class="anchor" aria-label="anchor" href="#arg--buffer-count"></a></dt>
<dd><p>number of total buffers (chunks) to run</p></dd>


<dt id="arg--output-size">.output_size<a class="anchor" aria-label="anchor" href="#arg--output-size"></a></dt>
<dd><p><code>fun</code> output vector length</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments passing to <code>fun</code></p></dd>


<dt id="arg--simplify">.simplify<a class="anchor" aria-label="anchor" href="#arg--simplify"></a></dt>
<dd><p>whether to apply <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></code> to
the result</p></dd>


<dt id="arg--input-size">.input_size<a class="anchor" aria-label="anchor" href="#arg--input-size"></a></dt>
<dd><p>number of elements to read from each array of <code>x</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>File array instance <code>.y</code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Denote the first argument of <code>fun</code> as <code>input</code>, The length
of <code>input</code> equals the length of <code>x</code>. The size of each
element of <code>input</code> is defined by <code>.input_size</code>, except for the
last loop. For example, given dimension of each input array as
\(10x10x10x10\), if <code>.input_size=100</code>, then
<code>length(input[[1]])=100</code>. The total number of runs equals to
<code>length(x[[1]])/100</code>. If <code>.input_size=300</code>, then
<code>length(input[[1]])</code> will be <code>300</code> except for the last run.
This is because \(10000\) cannot be divided by <code>300</code>.
The element length of the last run will be <code>100</code>.</p>
<p>The returned variable length of <code>fun</code> will be checked by
<code>.output_size</code>. If the output length exceed <code>.output_size</code>,
an error will be raised.</p>
<p>Please make sure that <code>length(.y)/length(x[[1]])</code> equals to
<code>.output_size/.input_size</code>.</p>
<p>For <code>fmap_element_wise</code>, the <code>input[[1]]</code> and output length
must be the consistent.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="filearray.html">filearray_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">20</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="filearray.html">filearray_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">20</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add two arrays</span></span></span>
<span class="r-in"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="filearray.html">filearray_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">20</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">input</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">input</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span>, <span class="va">output</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference class object of class "FileArray"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mode: readwrite </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension: 100x20x3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition count: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition size: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Storage type: double (internal size: 8)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location: /tmp/Rtmp4drOmk/file1cb814d29de8 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">output</span><span class="op">[</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span><span class="va">x1</span><span class="op">[</span><span class="op">]</span> <span class="op">+</span> <span class="va">x2</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">output</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the maximum of x1/x2 for every 100 elements</span></span></span>
<span class="r-in"><span><span class="co"># total 60 batches/loops (`.buffer_count`)</span></span></span>
<span class="r-in"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="filearray.html">filearray_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">input</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">input</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span>, .y <span class="op">=</span> <span class="va">output</span>, .buffer_count <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference class object of class "FileArray"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mode: readwrite </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension: 20x3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition count: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition size: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Storage type: double (internal size: 8)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location: /tmp/Rtmp4drOmk/file1cb843f052ce </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">output</span><span class="op">[</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="apply.html">apply</a></span><span class="op">(</span><span class="va">x1</span><span class="op">[</span><span class="op">]</span> <span class="op">/</span> <span class="va">x2</span><span class="op">[</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">output</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A large array example</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="filearray.html">filearray_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">287</span>, <span class="fl">100</span>, <span class="fl">301</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        Trial <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">287</span>,</span></span>
<span class="r-in"><span>        Marker <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>        Time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">301</span>,</span></span>
<span class="r-in"><span>        Location <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">x</span><span class="op">[</span>,,,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">8638700</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="co"># Step 1:</span></span></span>
<span class="r-in"><span>    <span class="co"># for each location, trial, and marker, calibrate (baseline)</span></span></span>
<span class="r-in"><span>    <span class="co"># according to first 50 time-points</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="filearray.html">filearray_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># baseline-percentage change</span></span></span>
<span class="r-in"><span>    <span class="fu">fmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="kw">function</span><span class="op">(</span><span class="va">input</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="co"># get locational data</span></span></span>
<span class="r-in"><span>            <span class="va">location_data</span> <span class="op">&lt;-</span> <span class="va">input</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">location_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">287</span>, <span class="fl">100</span>, <span class="fl">301</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>            <span class="co"># collapse over first 50 time points for</span></span></span>
<span class="r-in"><span>            <span class="co"># each trial, and marker</span></span></span>
<span class="r-in"><span>            <span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="apply.html">apply</a></span><span class="op">(</span><span class="va">location_data</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>            <span class="co"># calibrate</span></span></span>
<span class="r-in"><span>            <span class="va">calibrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">location_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">baseline</span>,</span></span>
<span class="r-in"><span>                                FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">bl</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>                                    <span class="op">(</span><span class="va">data</span> <span class="op">/</span> <span class="va">bl</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>                                <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">calibrated</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">}</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>        .y <span class="op">=</span> <span class="va">output</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>        <span class="co"># input dimension is 287 x 100 x 301 for each location</span></span></span>
<span class="r-in"><span>        <span class="co"># hence 4 loops in total</span></span></span>
<span class="r-in"><span>        .buffer_count <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># cleanup</span></span></span>
<span class="r-in"><span>    <span class="va">x</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cleanup</span></span></span>
<span class="r-in"><span><span class="va">x1</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">output</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhengjia Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

